# test incorrect usage of APPROX_VAR_SAMP function

statement error
SELECT APPROX_VAR_SAMP()
----
db error: ERROR: function `APPROX_VAR_SAMP` requires arguments: APPROX_VAR_SAMP(DOUBLE)


statement error
SELECT APPROX_VAR_SAMP(1, 2, 3)
----
db error: ERROR: wrong number of arguments for function `APPROX_VAR_SAMP`; expected: 1, provided: 3



statement error
SELECT APPROX_VAR_SAMP(APPROX_VAR_SAMP(1))
----
db error: ERROR: Aggregate function cannot be passed as an argument



# test sample variance on scalar values
query RR
SELECT APPROX_VAR_SAMP(3), APPROX_VAR_SAMP(NULL)
----
NULL NULL




# test sample variance on a set of values
statement ok
CREATE TABLE integers(x INT);

statement ok
INSERT INTO integers VALUES (10), (10), (20), (25), (30)

query R
SELECT APPROX_VAR_SAMP(x) FROM integers
----
80.000000


# test var on empty set
query RR
SELECT APPROX_VAR_SAMP(x) FROM integers WHERE x > 100
----
NULL


# test var with only null inputs
query RR
SELECT APPROX_VAR_SAMP(NULL), FROM integers
----
NULL


